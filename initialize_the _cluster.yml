---
 - hosts: master
   become: yes
   become_user: root
   tasks:
       - name: initialize the cluster
         shell: Kubeadm init
         args:
           chdir: $HOME
           creates: cluster_initialized.txt

       -   name: create .kube directory
           file:
            path: $HOME/.kube
            state: directory
            mode: 0755

       -   name: copies admin.conf to user's kube config
           copy:
            src: /etc/kubernetes/admin.conf
            dest: /home/kube/.kube/config
            remote_src: yes
            owner: ansadmin
